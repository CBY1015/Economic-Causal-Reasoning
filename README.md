# Economic-Causal-Reasoning
A Proof-of-Concept for an explainable Causal LLM, leveraging knowledge graphs and semantic matching for economic analysis.

---
**可解釋、結構化的經濟金融因果分析AI**

本專案旨在建構一個能夠理解並分析複雜因果關係的 AI 系統。它專門處理經濟金融領域的因果查詢，例如「Fed 升息對台灣科技業有何影響？」。透過結合**大型語言模型 (LLM)** 的語義理解能力和**知識圖譜**的結構化推理優勢，本系統提供一個可解釋、可追蹤的因果分析解決方案。

---
### 系統架構與工作原理

本系統採用混合智能架構，將複雜的因果推理過程分解為以下五個核心層次：

#### 1. 查詢解析層 (QueryParserLLM)

負責將使用者提出的自然語言問題，轉換為系統可識別的結構化查詢。

* **核心功能**：透過正則表達式和 `spaCy` 進行語法分析，精準地從句子中提取「**干預變數 (Intervention)**」和「**目標變數 (Target)**」。
* **輸出**：最終生成一個包含干預、目標和動作的結構化意圖，例如：`{intervention: "Fed raises rates", target: "Taiwan tech stocks", action: "deactivate"}`。

#### 2. 語義匹配層

將解析層提取出的短語，準確地對應到知識圖譜中已有的概念節點。

* **技術實現**：利用 `SentenceTransformer` 模型，將查詢短語和知識圖譜中的所有節點轉換成高維度的**語義向量**。

#### 3. 知識圖譜層

這是整個系統的「大腦」，以圖結構儲存和表示因果知識。

* **結構**：使用 `NetworkX` 函式庫構建一個有向圖。圖中的**節點**代表一個概念（如 "Fed raises rates"），並嵌入了其語義向量；**邊**則代表因果關係，並附帶元數據，如**關係類型**（`positive` 或 `negative`）和**置信度**。
* **知識庫**：目前知識庫包含 9 個經濟概念和 8 條因果關係鏈，涵蓋了從聯準會政策到台灣科技股之間的因果傳導路徑。

#### 4. 因果推理引擎

這是系統的核心，負責在知識圖譜上進行邏輯推理。

* **核心算法**：結合**圖路徑搜尋**和**效應傳播**。當接收到結構化意圖後，引擎會從干預節點開始，在圖中尋找一條通往目標節點的最短路徑。
* **效應計算**：沿著這條因果路徑，系統會根據干預動作（`activate` 或 `deactivate`）和節點的性質，判斷最終的因果效應是正面還是負面。

#### 5. 自然語言生成層

此層將推理引擎的結果轉化為人類可讀的自然語言回應。

* **生成策略**：根據因果推理得出的結論，利用預設的模板或一個輕量級的語言模型（如 `TinyLlama`）來產生最終的回應。這一步確保了答案的清晰易懂，同時保持了與原始查詢的邏輯連貫性。

---
### 當前系統限制

本專案是一個**概念驗證 (Proof of Concept)**，專注於展示混合智能架構在特定領域的應用潛力。

* **當前限制**：
    * **領域限定**：本系統的設計和知識庫都專門針對經濟金融領域。其解析、匹配和推理邏輯高度依賴於預設的經濟概念和規則，因此不具備通用性，無法處理其他領域的因果問題。
    * **知識庫有限**：目前的知識庫是靜態且規模有限的。
    * **推理簡化**：未考慮時間延遲、多路徑效應等更複雜的因果因素。
